var properties = [
  {
    "id": 1,
    "street": "4817 E 36th St",
    "city_state_zip": "Sioux Falls, SD 57110",
    "price": "$3,000",
    "image": "home-1.jpg",
    "sqft": 1826,
    "garage": 2,
    "bdrm": 3,
    "bath": 2,
    "status": "unavailable",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2893.1809424225457!2d-96.66890328438559!3d43.519419369089!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb6aa636b5123%3A0x7893cb0489cac60b!2s4817%20E%2036th%20St%2C%20Sioux%20Falls%2C%20SD%2057110!5e0!3m2!1sen!2sus!4v1614384800954!5m2!1sen!2sus"
  },
  {
    "id": 2,
    "street": "5109 W 55th St",
    "city_state_zip": "Sioux Falls, SD 57106",
    "price": "$3,500",
    "image": "home-2.jpg",
    "sqft": 1878,
    "garage": 2,
    "bdrm": 4,
    "bath": 3,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2893.9659404855015!2d-96.79153678438603!3d43.50304607014506!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878ec99cd41f49f9%3A0x621f586a5e896c60!2s5109%20W%2055th%20St%2C%20Sioux%20Falls%2C%20SD%2057106!5e0!3m2!1sen!2sus!4v1615738855681!5m2!1sen!2sus"
  },
  {
    "id": 3,
    "street": "6512 W 55th St",
    "city_state_zip": "Sioux Falls, SD 57106",
    "price": "$4,000",
    "image": "home-3.jpg",
    "sqft": 1896,
    "garage": 2,
    "bdrm": 4,
    "bath": 2,
    "status": "coming-soon",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2894.012385818332!2d-96.80938578438605!3d43.50207717020746!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878ec96f5eddd55f%3A0xa524670505b11a6a!2s6512%20W%2055th%20St%2C%20Sioux%20Falls%2C%20SD%2057106!5e0!3m2!1sen!2sus!4v1615740661526!5m2!1sen!2sus"
  },
  {
    "id": 4,
    "street": "5612 S Anthony Ave",
    "city_state_zip": "Sioux Falls, SD 57106",
    "price": "$2,500",
    "image": "home-4.jpg",
    "sqft": 1761,
    "garage": 2,
    "bdrm": 3,
    "bath": 2,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2894.358147197126!2d-96.81047408438621!3d43.494863670672686!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878ec96c8028563f%3A0x8f8644bcf130c2d1!2s5612%20S%20Anthony%20Ave%2C%20Sioux%20Falls%2C%20SD%2057106!5e0!3m2!1sen!2sus!4v1615740706337!5m2!1sen!2sus"
  },
  {
    "id": 5,
    "street": "1600 S Comet Rd",
    "city_state_zip": "Sioux Falls, SD 57103",
    "price": "$2,000",
    "image": "home-5.jpg",
    "sqft": 1596,
    "garage": 1,
    "bdrm": 3,
    "bath": 2,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2892.613644336553!2d-96.6860708843853!3d43.53124886832574!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb4164a7f62f1%3A0x5a5916319b7b8fcf!2s1600%20S%20Comet%20Rd%2C%20Sioux%20Falls%2C%20SD%2057103!5e0!3m2!1sen!2sus!4v1615740757942!5m2!1sen!2sus"
  },
  {
    "id": 6,
    "street": "1601 E Dana Dr",
    "city_state_zip": "Sioux Falls, SD 57105",
    "price": "$5,000",
    "image": "home-6.jpg",
    "sqft": 2100,
    "garage": 1,
    "bdrm": 3,
    "bath": 2.5,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2892.6104501033296!2d-96.71968838438532!3d43.531315468321395!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb5c5fef25f53%3A0x1a85b44250898110!2s1601%20E%20Dana%20Dr%2C%20Sioux%20Falls%2C%20SD%2057105!5e0!3m2!1sen!2sus!4v1615740786771!5m2!1sen!2sus"
  },
  {
    "id": 7,
    "street": "5512 S Danberry Dr",
    "city_state_zip": "Sioux Falls, SD 57106",
    "price": "$3,000",
    "image": "home-1.jpg",
    "sqft": 1200,
    "garage": 2,
    "bdrm": 3,
    "bath": 2,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2894.3187058279636!2d-96.80074318438623!3d43.49568657061964!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878ec9739dcef77d%3A0x4c7299dd91215f2a!2s5512%20S%20Danberry%20Dr%2C%20Sioux%20Falls%2C%20SD%2057106!5e0!3m2!1sen!2sus!4v1615740821037!5m2!1sen!2sus"
  },
  {
    "id": 8,
    "street": "2605 S Groveland Ave",
    "city_state_zip": "Sioux Falls, SD 57110",
    "price": "$3,500",
    "image": "home-2.jpg",
    "sqft": 2084,
    "garage": 2,
    "bdrm": 3,
    "bath": 2,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2893.066188346443!2d-96.66957148438557!3d43.521812468934534!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb401bb3ed0a3%3A0x24ecbbaf0a9d9365!2s2605%20S%20Groveland%20Ave%2C%20Sioux%20Falls%2C%20SD%2057110!5e0!3m2!1sen!2sus!4v1615740847997!5m2!1sen!2sus"
  },
  {
    "id": 9,
    "street": "2612 S Groveland Ave",
    "city_state_zip": "Sioux Falls, SD 57110",
    "price": "$4,000",
    "image": "home-3.jpg",
    "sqft": 2102,
    "garage": 2,
    "bdrm": 3,
    "bath": 2,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2893.0673200397114!2d-96.66869448438557!3d43.5217888689361!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb4004d2ab80f%3A0x599297bd22fbf73f!2s2612%20S%20Groveland%20Ave%2C%20Sioux%20Falls%2C%20SD%2057110!5e0!3m2!1sen!2sus!4v1615740874933!5m2!1sen!2sus"
  },
  {
    "id": 10,
    "street": "1921 S Jefferson Ave",
    "city_state_zip": "Sioux Falls, SD 57105",
    "price": "$2,500",
    "image": "home-4.jpg",
    "sqft": 1104,
    "garage": 1,
    "bdrm": 3,
    "bath": 1,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2892.785724277296!2d-96.75470348438539!3d43.52766086855721!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eca090f662d3f%3A0x58ed6744f800e3f7!2s1921%20S%20Jefferson%20Ave%2C%20Sioux%20Falls%2C%20SD%2057105!5e0!3m2!1sen!2sus!4v1615740902389!5m2!1sen!2sus"
  },
  {
    "id": 11,
    "street": "3804 S Lewis Ave",
    "city_state_zip": "Sioux Falls, SD 57103",
    "price": "$2,000",
    "image": "home-5.jpg",
    "sqft": 2436,
    "garage": 2,
    "bdrm": 3,
    "bath": 3,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2893.657076430277!2d-96.70303418438584!3d43.509488869729466!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb685e6bf05a9%3A0x3f43d0891a6f1549!2s3804%20S%20Lewis%20Ave%2C%20Sioux%20Falls%2C%20SD%2057103!5e0!3m2!1sen!2sus!4v1615740925724!5m2!1sen!2sus"
  },
  {
    "id": 12,
    "street": "2717 S Maywood Dr",
    "city_state_zip": "Sioux Falls, SD 57110",
    "price": "$5,000",
    "image": "home-6.jpg",
    "sqft": 2065,
    "garage": 2,
    "bdrm": 3,
    "bath": 2,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2893.133978784553!2d-96.67007268438557!3d43.52039876902582!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb401e7433423%3A0x851cde0b8696fa5a!2s2717%20S%20Maywood%20Dr%2C%20Sioux%20Falls%2C%20SD%2057110!5e0!3m2!1sen!2sus!4v1615740955173!5m2!1sen!2sus"
  },
  {
    "id": 13,
    "street": "2612 S Melanie Ln",
    "city_state_zip": "Sioux Falls, SD 57103",
    "price": "$3,000",
    "image": "home-1.jpg",
    "sqft": 1470,
    "garage": 2,
    "bdrm": 3,
    "bath": 2,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2893.021951222815!2d-96.67683908438552!3d43.522734968875056!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb41ccd0dafb3%3A0x40886955be231056!2s2612%20S%20Melanie%20Ln%2C%20Sioux%20Falls%2C%20SD%2057103!5e0!3m2!1sen!2sus!4v1615740985363!5m2!1sen!2sus"
  },
  {
    "id": 14,
    "street": "2600 W Minnehaha Dr",
    "city_state_zip": "Sioux Falls, SD 57105",
    "price": "$3,500",
    "image": "home-2.jpg",
    "sqft": 1737,
    "garage": 2,
    "bdrm": 3,
    "bath": 2.5,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2892.896361658592!2d-96.75955488438547!3d43.52535386870623!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eca0f7590897d%3A0x1fff05d51906a9c8!2s2600%20W%20Minnehaha%20Dr%2C%20Sioux%20Falls%2C%20SD%2057105!5e0!3m2!1sen!2sus!4v1615741014787!5m2!1sen!2sus"
  },
  {
    "id": 15,
    "street": "1813 S Monticello Ave",
    "city_state_zip": "Sioux Falls, SD 57106",
    "price": "$4,000",
    "image": "home-3.jpg",
    "sqft": 2100,
    "garage": 3,
    "bdrm": 4,
    "bath": 3,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2892.7628480827957!2d-96.8287887843854!3d43.5281378685264!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878ecbf2514cb40d%3A0xcdb0ef96309cbdf8!2s1813%20S%20Monticello%20Ave%2C%20Sioux%20Falls%2C%20SD%2057106!5e0!3m2!1sen!2sus!4v1615741056144!5m2!1sen!2sus"
  },
  {
    "id": 16,
    "street": "2809 S Pepper Ridge Ave",
    "city_state_zip": "Sioux Falls, SD 57103",
    "price": "$2,500",
    "image": "home-4.jpg",
    "sqft": 1800,
    "garage": 2,
    "bdrm": 3,
    "bath": 2,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2893.0816052273826!2d-96.67539798438555!3d43.52149096895542!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb402c2a76ccd%3A0xc2f44cf0b5e8ce86!2s2809%20S%20Pepper%20Ridge%20Ave%2C%20Sioux%20Falls%2C%20SD%2057103!5e0!3m2!1sen!2sus!4v1615741087299!5m2!1sen!2sus"
  },
  {
    "id": 17,
    "street": "4616 S Samantha Dr",
    "city_state_zip": "Sioux Falls, SD 57106",
    "price": "$2,000",
    "image": "home-5.jpg",
    "sqft": 1495,
    "garage": 3,
    "bdrm": 3,
    "bath": 2,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2893.908837813036!2d-96.819599384386!3d43.50423727006818!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878ec95c5edd4b47%3A0x3e37ab6b40c3619c!2s4616%20S%20Samantha%20Dr%2C%20Sioux%20Falls%2C%20SD%2057106!5e0!3m2!1sen!2sus!4v1615741113123!5m2!1sen!2sus"
  },
  {
    "id": 18,
    "street": "4016 S Tuscany Ct",
    "city_state_zip": "Sioux Falls, SD 57103",
    "price": "$5,000",
    "image": "home-6.jpg",
    "sqft": 1952,
    "garage": 3,
    "bdrm": 4,
    "bath": 3,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2893.701178136248!2d-96.6839194843859!3d43.50856896978892!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb6bcc2e5e753%3A0x398500ef3331cb4b!2s4016%20S%20Tuscany%20Ct%2C%20Sioux%20Falls%2C%20SD%2057103!5e0!3m2!1sen!2sus!4v1615741190189!5m2!1sen!2sus"
  },
  {
    "id": 19,
    "street": "3000 S Walts Ave",
    "city_state_zip": "Sioux Falls, SD 57105",
    "price": "$3,000",
    "image": "home-1.jpg",
    "sqft": 1311,
    "garage": 1,
    "bdrm": 3,
    "bath": 2,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2893.2723114645246!2d-96.74059068438565!3d43.51751386921196!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb5e2cc3233d1%3A0xa3ec2fadab0b4397!2s3000%20S%20Walts%20Ave%2C%20Sioux%20Falls%2C%20SD%2057105!5e0!3m2!1sen!2sus!4v1615741219776!5m2!1sen!2sus"
  },
  {
    "id": 20,
    "street": "608 E Wiswall Pl",
    "city_state_zip": "Sioux Falls, SD 57105",
    "price": "$3,500",
    "image": "home-2.jpg",
    "sqft": 1802,
    "garage": 2,
    "bdrm": 4,
    "bath": 2.5,
    "status": "available",
    "map": "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2892.5407994996267!2d-96.7207542843853!3d43.53276766822778!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x878eb5c63f9ebf89%3A0x832079e758321ebe!2s608%20E%20Wiswall%20Pl%2C%20Sioux%20Falls%2C%20SD%2057105!5e0!3m2!1sen!2sus!4v1615741245121!5m2!1sen!2sus"
  }
];

var prop_card = "";
prop_card += "<div class=\"col-sm-6 col-md-4 mb-5\">";
prop_card += "<div class=\"card\">";
prop_card += "<div class=\"card-img-wrapper %data-status%\">";
prop_card += "<span class=\"card-price\">%data-price%</span>";
prop_card += "<img class=\"card-img-top\" src=\"images/exterior/%data-image%\" />";
prop_card += "</div>";
prop_card += "<div class=\"card-body\">";
prop_card += "<h5 class=\"card-title\">";
prop_card += "%data-street%";
prop_card += "<span>%data-city_state_zip%</span>";
prop_card += "</h5>";
prop_card += "<div class=\"card-details\">";
prop_card += "<div class=\"card-details-item\">";
prop_card += "<div><i class=\"fa fa-th-large\"></i> Sqft: %data-sqft%</div>";
prop_card += "<div><i class=\"fa fa-bed\"></i> Bdrm: %data-bdrm%</div>";
prop_card += "</div>";
prop_card += "<div class=\"card-details-item\">";
prop_card += "<div><i class=\"fa fa-car\"></i> Garage: %data-garage%</div>";
prop_card += "<div><i class=\"fa fa-shower\"></i> Bath: %data-bath%</div>";
prop_card += "</div>";
prop_card += "<div class=\"card-details-item w-100\"></div>";
prop_card += "<div class=\"card-details-item w-100\">";
prop_card += "<Button onClick=\"%data-click%\" class=\"btn btn-more\">MORE INFO</Button>";
prop_card += "</div></div></div></div></div>";

var card_forms = Array.prototype.slice.call(document.querySelectorAll(".card-form"));
var list = document.getElementById("formDropdownContent");
var property_content = document.getElementById("property-content");
var page_list = document.getElementById("page-list");
var page_index = 0;
var page_count = 0;
var co_applicant = true;
var time = document.getElementById("time");
var date = document.getElementById("date");
var hero_text = document.getElementById("hero-text");
var terms = document.getElementById("terms");
var agree = document.getElementById("btnAgree");
var exterior_image = document.getElementById("exterior-image");
var interior_image = document.getElementById("interior-image");
var dashboard_tbody = document.getElementById("dashboard-tbody");

function getPages(perPageLimit, data) {
  const arr = data.slice();
  const pages = [];

  while (arr.length) {
    pages.push(arr.splice(0, perPageLimit));
  }

  return pages;
}

function getPageContent() {
  var str = "";
  var pages = getPages(6, properties);

  pages[page_index].forEach(function (property) {
    var tmp = prop_card;
    Object.keys(property).forEach(function (k) {
      tmp = tmp.replace("%data-" + k + "%", property[k]);
    });

    var url = "location.href='property_details.html?id=" + property.id + "'";
    tmp = tmp.replace("%data-click%", url);

    str += tmp;
  });

  return str;
}

function showPage(index, el, e) {
  if (e) {
    e.preventDefault();
  }

  page_index = index;
  el.innerHTML = getPageContent();
  $(el).hide().fadeIn(1000, renderPageLinks());
  page_list.scrollIntoView();
}

function renderPageLinks() {
  page_list.innerHTML = "";
  var li = document.createElement("li");
  li.className = page_index === 0 ? "page-item disabled" : "page-item";
  var a = document.createElement("a");
  a.className = "page-link";
  a.href = "#";
  a.innerHTML = "<i class=\"fa fa-chevron-left\"></i>";
  a.addEventListener("click", showPage.bind(this, page_index - 1, property_content));
  li.appendChild(a);
  page_list.appendChild(li);

  for (var i = 0; i < page_count; i++) {
    li = document.createElement("li");
    li.className = page_index === i ? "page-item active" : "page-item";
    a = document.createElement("a");
    a.href = "#";
    a.className = "page-link";
    a.innerText = (i + 1).toString();
    a.addEventListener("click", showPage.bind(this, i, property_content));
    li.appendChild(a);
    page_list.appendChild(li);
  }

  li = document.createElement("li");
  li.className = page_index === page_count - 1 ? "page-item disabled" : "page-item";
  var a = document.createElement("a");
  a.className = "page-link";
  a.href = "#";
  a.innerHTML = "<i class=\"fa fa-chevron-right\"></i>";
  a.addEventListener("click", showPage.bind(this, page_index + 1, property_content));
  li.appendChild(a);
  page_list.appendChild(li);
}

if (page_list) {
  var pages = getPages(6, properties);
  page_count = pages.length;

  showPage(0, property_content);
}

function timepicker(el, obj) {
  for (var i = obj.min; i <= obj.max; i++) {
    var hour = i > 12 ? i - 12 : i;
    var ampm = i >= 12 ? "pm" : "am";
    var mins;

    hour = hour.toString().length < 2 ? "&nbsp;" + hour.toString() : hour.toString();

    for (var j = 0; j < 60; j += obj.step) {
      var option = document.createElement("option");
      mins = j % 60;
      mins = mins.toString().length < 2 ? "0" + mins.toString() : mins.toString();
      option.innerHTML = hour + ":" + mins + " " + ampm;
      el.add(option);

      if (i === obj.max) {
        break;
      }
    }
  }
}

function hideForm(form, func) {
  $(form.parentElement).hide(0, func);
}

function showForm(forms, index, dir) {
  window.scrollTo(0, 0);
  if (!co_applicant) {
    index = (index === 7 && dir === 'back') ? index - 3 : (index === 5 && dir === 'next') ? index + 3 : index;
  }
  $(forms[index].parentElement).fadeIn(1000);
}

function typeWriter(len, str, speed, el) {
  if (len < 0) {
    setTimeout(typeWriter.bind(this, len + 1, str, speed, el), 1750);
  }
  else {
    if (len < str.length) {
      el.innerHTML += str.charCodeAt(len) === 10 ? "<br>" : str.charAt(len);
      len++;
      setTimeout(typeWriter.bind(this, len, str, speed, el), speed);
    }
  }
}

card_forms.forEach(function (form, index) {
  var back = form.querySelector('#btnBack');
  var next = form.querySelector('#btnNext');

  if (back) {
    back.addEventListener("click", function () {
      hideForm(form, showForm(card_forms, index - 1, 'back'));
    });
  }

  if (next) {
    next.addEventListener("click", function () {
      hideForm(form, showForm(card_forms, index + 1, 'next'));
    });
  }

  if (index > 0) {
    form.parentElement.style.display = "none";
  }
});


$(
  $('#navbarToggler').click(function (e) {
    e.preventDefault();
    $('#navbarTogglerContent').slideToggle(1000);
  })
);

$(
  $('#navbarRentDropdown').click(function (e) {
    e.preventDefault();
    $('#navbarAdminDropdownContent').slideUp(500);
    $('#navbarRentDropdownContent').slideToggle(500);
  })
);

$(
  $('#navbarAdminDropdown').click(function (e) {
    e.preventDefault();
    $('#navbarRentDropdownContent').slideUp(500);
    $('#navbarAdminDropdownContent').slideToggle(500);
  })
);

$(
  $(document).click(function (e) {
    // Check if click was triggered on or within #menu_content
    if ($(e.target).closest("#navbarRentDropdownContent").length > 0) {
      location.href = e.target.href;
      return false;
    }
    else {
      $('#navbarRentDropdownContent').slideUp(500);
    }

    if ($(e.target).closest("#navbarAdminDropdownContent").length > 0) {
      location.href = e.target.href;
      return false;
    }
    else {
      $('#navbarAdminDropdownContent').slideUp(500);
    }
  })
);

if (date) {
  $(
    $("#date").datepicker({
      minDate: 0, beforeShowDay: function (date) {
        var day = date.getDay();
        return [(day !== 0), ''];
      }
    })
  )
}

if (time) {
  timepicker(time, { min: 9, max: 18, step: 15 });
}

try {
  lightbox.option({ 'wrapAround': true });
}
catch (err) {
}

$(function () {
  if (hero_text) {
    $('body').css("display", "flex").hide().fadeIn(2000, typeWriter(-1, "Rent your next home\nin beautiful Sioux Falls today!", 100, hero_text));
  }
  else {
    $('body').css("display", "flex").hide().fadeIn(2000)
  }
}
)

function showContent(elements, content, testValues) {
  var values = elements.filter(function (el) {
    return el.checked;
  }).map(function (el) {
    return el.value;
  });

  if (values.some(function (value) {
    return testValues.indexOf(value) >= 0;
  })) {
    $(content).slideDown(500);
  }
  else {
    $(content).slideUp(500);
  }
}

function repeatContent(element, content) {
  var value = element.value;
  var children = Array.prototype.slice.call(content.children);

  if (!isNaN(value) && value > 0) {
    children.forEach(function (child, index) {
      child.style.display = "none";
      if ((index + 1) <= value) {
        child.style.display = "block";
      }
    });

    $(content).slideDown(500);
  }
  else {
    children.forEach(function (child) {
      child.style.display = "none";
    });

    $(content).slideUp(500);
  }
}

var triggers = [
  {
    "trigger": "input[name='applicant-current-status']",
    "content": "applicant-current-status-content",
    "function": showContent,
    "arguments": ['full time', 'part time']

  },
  {
    "trigger": "input[name='applicant-previous-employment-question']",
    "content": "applicant-previous-employment-content",
    "function": showContent,
    "arguments": ['yes']
  },
  {
    "trigger": "input[name='co-applicant-question']",
    "content": "co-applicant-question-content",
    "function": showContent,
    "arguments": ['yes']
  },
  {
    "trigger": "input[name='co-applicant-current-status']",
    "content": "co-applicant-current-status-content",
    "function": showContent,
    "arguments": ['full time', 'part time']
  },
  {
    "trigger": "input[name='co-applicant-previous-employment-question']",
    "content": "co-applicant-previous-employment-content",
    "function": showContent,
    "arguments": ['yes']
  },
  {
    "trigger": "input[name='previous-residence-status']",
    "content": "previous-residence-status-content",
    "function": showContent,
    "arguments": ['yes']
  },
  {
    "trigger": "#applicant-number-dependents",
    "content": "dependents",
    "function": repeatContent,
    "arguments": null
  },
  {
    "trigger": "#applicant-number-vehicles",
    "content": "vehicles",
    "function": repeatContent,
    "arguments": null
  },
  {
    "trigger": "input[type='radio'][id^='applicant-credit-history-']",
    "content": "applicant-credit-history-explain",
    "function": showContent,
    "arguments": ['yes']
  },
  {
    "trigger": "input[type='radio'][id^='co-applicant-credit-history-']",
    "content": "co-applicant-credit-history-explain",
    "function": showContent,
    "arguments": ['yes']
  }
];

triggers.forEach(function (obj) {
  obj.trigger = Array.prototype.slice.call(document.querySelectorAll(obj.trigger));
  obj.content = document.getElementById(obj.content);
  var event = obj.function === showContent ? "click" : "change";

  obj.trigger.forEach(function (el) {
    el.addEventListener(event, obj.function.bind(this, obj.trigger.length > 1 ? obj.trigger : el, obj.content, obj.arguments));
  });
});

triggers = Array.prototype.slice.call(document.querySelectorAll("input[name='co-applicant-question']"));

triggers.forEach(function (trigger) {
  trigger.addEventListener("click", function () {
    if (this.value === 'no') {
      co_applicant = false;
    }
    else {
      co_applicant = true;
    }
  });
});

if (terms && agree) {
  agree.addEventListener("click", function () {
    terms.checked = true;
  });
}

if (location.search) {
  var id = Number(location.search.replace('?id=', ''));
  var els = document.querySelectorAll(".main-heading h1, .main-heading p, #property-main-image, #map-container, #details-sqft, #details-garage, #details-bdrm, #details-bath, #details-price");

  if (els.length) {
    var property = properties.filter(function (property) {
      return property.id === id;
    });

    if (property.length) {
      var iframe = document.createElement("iframe");
      iframe.className = "img-shadow";
      iframe.style.border = "0";
      iframe.style.width = "100%";
      iframe.setAttribute("allowfullscreen", "");
      iframe.setAttribute("loading", "lazy");
      iframe.src = property[0].map;

      var button = document.createElement("button");
      button.className = "btn btn-schedule mt-1";
      button.setAttribute("data-toggle", "modal");
      button.setAttribute("data-target", "#exampleModal");
      button.innerHTML = "SCHEDULE SHOWING";

      els[0].innerHTML = property[0].street;
      els[1].innerHTML = property[0].city_state_zip;
      els[2].src = "images/exterior/" + property[0].image;
      els[2].alt = property[0].street;
      els[3].appendChild(iframe);

      if (property[0].status === "available") {
        els[3].appendChild(button);
      }

      els[4].innerHTML = property[0].sqft;
      els[5].innerHTML = property[0].garage;
      els[6].innerHTML = property[0].bdrm;
      els[7].innerHTML = property[0].bath;
      els[8].innerHTML = property[0].price;
    }
  }
}

if (exterior_image && interior_image) {
  var images = [
    {
      "element": exterior_image,
      "message": "(select an image)"
    },
    {
      "element": interior_image,
      "message": "(select up to six images)"
    }
  ];

  images.forEach(function (image) {
    var custom_file_label = image.element.nextElementSibling;

    image.element.addEventListener("change", function () {
      custom_file_label.innerHTML = image.element.files.length ? Array.prototype.slice.call(image.element.files).map(function (file) {
        return file.name;
      }).join(", ") : image.message;
    });
  });
}

if (dashboard_tbody) {
  properties.forEach(function (property, index) {
    var tr = document.createElement("tr");
    var td = document.createElement("td");

    td.innerHTML = property.street + "<br>" + property.city_state_zip;
    tr.appendChild(td);

    td = document.createElement("td");
    td.innerHTML = property.status.replace('-', ' ');
    tr.appendChild(td);

    td = document.createElement("td");
    td.innerHTML = property.price;
    tr.appendChild(td);

    var a = document.createElement("a");
    a.href = "javascript:void(null)";
    a.className = "dashboard-link";
    a.innerHTML = "<i class=\"fa fa-pencil mr-2\"></i>";
    a.setAttribute("data-toggle", "tooltip");
    a.setAttribute("data-placement", "bottom");
    a.setAttribute("title", "edit property");

    if (index === 0) {
      a.href = "edit_property.html";
    }

    td = document.createElement("td");
    td.appendChild(a);

    a = document.createElement("a");
    a.href = "javascript:void(null)";
    a.className = "dashboard-link";
    a.innerHTML = "<i class=\"fa fa-trash\" onClick=\"showModal('" + property.street + ", " + property.city_state_zip + "');\"></i>";
    a.setAttribute("data-toggle", "tooltip");
    a.setAttribute("data-placement", "bottom");
    a.setAttribute("title", "delete property");

    td.appendChild(a);
    tr.appendChild(td);
    dashboard_tbody.appendChild(tr);
  });
}

$(
  $(function () {
    $('[data-toggle="tooltip"]').tooltip({ "boundary": 'window' });
  })
)

function showModal(content) {
  var myModal = document.getElementById("myModal");
  var modal_body = myModal.querySelector(".modal-body");

  if (myModal && modal_body) {
    modal_body.innerHTML = "<p>You have chosen to delete property " + content + ". Click 'Confirm' to proceed or 'Cancel' to abort.</p>";
    $(myModal).modal('show');
  }
}